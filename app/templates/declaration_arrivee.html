<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <title>DÃ©claration dâ€™arrivÃ©e</title>
  <link rel="stylesheet" href="/static/style.css">
  <script>
    async function loadMarchandises() {
      const imo = document.getElementById("navireSelect").value;
      if (imo) {
        const response = await fetch(`/declarations/marchandises/${imo}`);
        const html = await response.text();
        document.getElementById("marchandisesList").innerHTML = html;
      }
    }
  </script>
</head>
<body>

  <header>
    <h1>ðŸ“¥ DÃ©claration dâ€™arrivÃ©e</h1>
  </header>

  <section class="card">
    <form method="post" action="/declarations/arrivee/download">
      <!-- Menu dÃ©roulant des navires -->
      <div class="form-row">
        <label>Nom du navire</label>
        <select id="navireSelect" name="navire_imo" onchange="loadMarchandises()" required>
          <option value="">-- SÃ©lectionnez un navire --</option>
          {% for navire in navires %}
            <option value="{{ navire.imo }}">{{ navire.nom }} (IMO: {{ navire.imo }})</option>
          {% endfor %}
        </select>
      </div>

      <!-- Port dâ€™arrivÃ©e -->
      <div class="form-row">
        <label>Port dâ€™arrivÃ©e</label>
        <input type="text" name="port" required>
      </div>

      <!-- Date dâ€™arrivÃ©e -->
      <div class="form-row">
        <label>Date dâ€™arrivÃ©e</label>
        <input type="date" name="date" required>
      </div>

      <!-- Marchandises embarquÃ©es (chargÃ©es dynamiquement) -->
      <div class="form-row">
        <label>Marchandises embarquÃ©es</label>
        <div id="marchandisesList">
          <em>SÃ©lectionnez un navire pour voir ses marchandises</em>
        </div>
      </div>

      <button type="submit">ðŸ“„ TÃ©lÃ©charger la dÃ©claration</button>
    </form>
  </section>

  <footer>
    MarineGab â€” Par <font color="#FFD700"><b>OLOUOMO LAB</b></font> Â© 2025
  </footer>

</body>
</html>
